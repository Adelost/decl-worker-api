{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "media.schema.json",
  "title": "Media Reference Types",
  "description": "References to media files - NEVER raw data, always URLs",

  "definitions": {
    "ImageRef": {
      "type": "object",
      "description": "Reference to an image file",
      "required": ["url"],
      "properties": {
        "url": {
          "type": "string",
          "description": "S3/GCS/HTTP URL to image"
        },
        "format": {
          "type": ["string", "null"],
          "enum": ["jpg", "png", "webp", null]
        },
        "width": { "type": ["integer", "null"] },
        "height": { "type": ["integer", "null"] }
      }
    },

    "VideoRef": {
      "type": "object",
      "description": "Reference to a video file",
      "required": ["url"],
      "properties": {
        "url": {
          "type": "string",
          "description": "S3/GCS/HTTP URL to video"
        },
        "format": {
          "type": ["string", "null"],
          "enum": ["mp4", "webm", "mov", null]
        },
        "duration_seconds": { "type": ["number", "null"] },
        "fps": { "type": ["number", "null"] },
        "width": { "type": ["integer", "null"] },
        "height": { "type": ["integer", "null"] }
      }
    },

    "AudioRef": {
      "type": "object",
      "description": "Reference to an audio file",
      "required": ["url"],
      "properties": {
        "url": {
          "type": "string",
          "description": "S3/GCS/HTTP URL to audio"
        },
        "format": {
          "type": ["string", "null"],
          "enum": ["mp3", "wav", "flac", "m4a", null]
        },
        "duration_seconds": { "type": ["number", "null"] },
        "sample_rate": { "type": ["integer", "null"] },
        "channels": { "type": ["integer", "null"] }
      }
    },

    "VisionPayload": {
      "type": "object",
      "description": "Payload for vision tasks (YOLO, SAM2, etc)",
      "required": ["image"],
      "properties": {
        "image": { "$ref": "#/definitions/ImageRef" },
        "confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 0.25
        }
      }
    },

    "TranscriptionPayload": {
      "type": "object",
      "description": "Payload for audio transcription",
      "required": ["audio"],
      "properties": {
        "audio": { "$ref": "#/definitions/AudioRef" },
        "language": {
          "type": ["string", "null"],
          "description": "ISO 639-1 language code"
        },
        "word_timestamps": {
          "type": "boolean",
          "default": false
        }
      }
    }
  }
}
